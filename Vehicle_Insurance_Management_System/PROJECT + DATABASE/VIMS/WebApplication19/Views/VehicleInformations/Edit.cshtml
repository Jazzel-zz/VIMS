@model VIMS.Models.VehicleInformation

@{
    ViewBag.Title = "Edit";
}




<div class="card shadow-lg">
    <div class="card-body">
        <h2>Edit</h2>

        @using (Html.BeginForm(null, null, FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
            @Html.AntiForgeryToken()

            <div class="form-horizontal">
                <h4>VehicleInformation</h4>
                <hr />
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                @Html.HiddenFor(model => model.VehicleInformationId)
                @Html.HiddenFor(model => model.ApplicationUserId)
                <div class="row">
                    <div class="col">

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleCompany, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleCompany, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleCompany, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleName, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleName, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleName, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleColor, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleColor, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleColor, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleModel, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleModel, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleModel, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        @*<div class="form-group">
            @Html.LabelFor(model => model.ApplicationUserId, "ApplicationUserId", htmlAttributes: new { @class = "control-label col-12" })
            <div class="col-12">
                @Html.DropDownList("ApplicationUserId", null, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.ApplicationUserId, "", new { @class = "text-danger" })
            </div>
        </div>*@

                        <div class="form-group" style="display:none;">
                            @Html.LabelFor(model => model.VehicleWarranty, "ApplicationUserId", htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleWarranty, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleWarranty, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleRate, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleRate, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleRate, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleBodyNumber, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleBodyNumber, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleBodyNumber, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleEngineNumber, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleEngineNumber, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleEngineNumber, "", new { @class = "text-danger" })
                            </div>
                        </div>

                    </div>
                    <div class="col">

                       

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleNumber, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleNumber, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleNumber, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(model => model.VehicleDescription, htmlAttributes: new { @class = "control-label col-12" })
                            <div class="col-12">
                                @Html.EditorFor(model => model.VehicleDescription, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.VehicleDescription, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="control-label col-12">Images</label>

                            <div class="col-12">
                                <ul class="attachment w-100 border mb-3" style="list-style:none;">
                                    <li class="m-3">
                                        <input type="file" name="file" multiple="multiple" accept="image/x-png,image/gif,image/jpeg" />

                                    </li>
                                    @foreach (var item in Model.VehicleImages)
                                    {
                                        <li class="border">
                                            <div class="row">
                                                <div class="col-10">
                                                    <a class="title" href="/VehicleInformations/Download/?p=@(item.Id + item.Extension)&d=@item.FileName">
                                                        <img src="../../Data/@(item.Id + item.Extension)" class="img-thumbnail float-left" width="120" height="90" />
                                                        <p class="float-left ml-2 mt-3 p-2">@item.FileName</p>
                                                    </a>
                                                </div>
                                                <div class="col-2">
                                                    <a href="javascript:void(0);" data-id="@item.Id" class="deleteItem float-right mr-3 mt-3 p-2"><i class="fa fa-trash text-danger h3" aria-hidden="true"></i></a>
                                                </div>
                                            </div>
                                        </li>
                                    }
                                    <br />
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
                <div class="form-group">
                    <div class="col-md-offset-2 col-12">
                        <input type="submit" value="Save" class="btn btn-dark btn-lg w-100" />
                    </div>
                </div>
            </div>

        }

    </div>
</div>

@section Scripts {
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script>
    $('.deleteItem').click(function (e) {
           e.preventDefault();
           var $ctrl = $(this);
           if (confirm('Do you really want to delete this file?')) {
               $.ajax({
                   url: '@Url.Action("DeleteFile")',
                   type: 'POST',
                   data: { id: $(this).data('id') }
               }).done(function (data) {
                   if (data.Result == "OK") {
                       $ctrl.closest('li').remove();
                   }
                   else if (data.Result.Message) {
                       alert(data.Result.Message);
                   }
               }).fail(function () {
                   alert("There is something wrong. Please try again.");
               })

           }
       });
    </script>

}
